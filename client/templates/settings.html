<template name="settings">
  {{#unless currentPersonId}}
    <h1>Settings</h1>
    <p>Sign in to view your settings.</p>
  {{else}}
    <div class="row">
      <h1>{{> personAvatar currentPerson}} {{currentPerson.getDisplayName}} settings</h1>
      {{> settingsUsername}}
      {{> settingsPassword}}
    </div>
  {{/unless}}
</template>

<template name="settingsUsername">
  {{#unless usernameExists}}
    <form class="set-username">
      <div class="form-control-group">
        <label for="set-username-username">Username</label>
        <input type="text" id="set-username-username" class="username {{validity 'username'}}" />
        {{#with messageOnField "username"}}
          {{> formMessage}}
        {{/with}}
      </div>

      <div class="form-control-group">
        <button class="set-username">Set username</button>
        {{! Global form message }}
        {{> formMessage messageOnField}}
      </div>
    </form>
  {{/unless}}
</template>

<template name="settingsPassword">
  <form class="set-password">
    <div class="form-control-group">
      <label for="set-password-current-password">Current password</label>
      <input type="password" id="set-password-current-password" class="current-password {{validity 'current-password'}}" />
      {{#with messageOnField "current-password"}}
        {{> formMessage}}
      {{/with}}
    </div>

    <div class="form-control-group">
      <label for="set-password-new-password">New password</label>
      <input type="password" id="set-password-new-password" class="new-password {{validity 'new-password'}}" />
      {{#with messageOnField "new-password"}}
        {{> formMessage}}
      {{/with}}
    </div>

    <div class="form-control-group">
      <button class="change-password">Change password</button>
      {{! Global form message }}
      {{> formMessage messageOnField}}
    </div>
  </form>
</template>

<template name="formMessage">
  {{#if errorMessage}}
    <div class="form-message error">{{errorMessage}}</div>
  {{/if}}
  {{#if infoMessage}}
    <div class="form-message info">{{infoMessage}}</div>
  {{/if}}
</template>
