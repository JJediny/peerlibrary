<template name="group">
  {{#if loading}}
    <div class="loading">
      <h2>Loading</h2>
    </div>
  {{else}}
    {{#if notFound}}
      <div class="not-found">
        <h2>404 Not found</h2>
        <p>Group not found. You might lack permissions to access it.{{#unless currentPersonId}} Try signing in.{{/unless}}</p>
      </div>
    {{else}}
      {{> groupName group}}
      <div class="row">
        <div class="col12 groups-directory">
          <h2>Group Activity</h2>
        </div>
        <div class="col4 push12 sidebar group-members-panel">
          {{> groupMembers group}}
          {{> groupDetails group}}
        </div>
      </div>
    {{/if}}
  {{/if}}
</template>

<template name="groupName">
  <h1>{{name}}</h1>
</template>

<template name="groupMembers">
  <h2 class="directory-title">Members</h2>
  {{> groupMembersList}}
  {{#if canModifyMembership}}
    {{> groupMembersAddControl}}
  {{/if}}
</template>

<template name="groupMembersList">
  <ol class="members member-list {{#unless canModifyMembership}}read-only{{/unless}}">
    {{#each members}}
      {{> member}}
    {{/each}}
  </ol>
</template>

<template name="groupMembersAddControl">
  <h3>Add a member</h3>
  <div class="add-control">
    <input type="text" class="add-group-member" placeholder="Search by username, name, or email" />
    {{> groupMembersAddControlNoResults}}
    {{> groupMembersAddControlResults}}
    {{> groupMembersAddControlLoading}}
  </div>
  <p class="hint">Enter an email to add and invite the user.</p>
</template>

<template name="groupMembersAddControlNoResults">
  {{#if noResults}}
    <div class="no-results add-control-results">
      No people found
      {{> addControlInviteByEmail email}}
    </div>
  {{/if}}
</template>

<template name="addControlInviteByEmail">
  {{#if this}}
    <button class="add-and-invite">Add and invite {{this}}</button>
  {{/if}}
</template>

<template name="groupMembersAddControlResults">
  {{#if results.count}}
    <ul class="group-member-results add-control-results">
      {{#each results}}
        {{> groupMembersAddControlResultsItem}}
      {{/each}}
    </ul>
  {{/if}}
</template>

<template name="groupMembersAddControlResultsItem">
  {{> memberAdd}}
</template>

<template name="groupMembersAddControlLoading">
  {{#if loading}}
    <div class="results-loading add-control-results">Loading â€¦</div>
  {{/if}}
</template>

<template name="groupDetails">
  {{#if canModify}}
    <h3>Tools</h3>
    {{#if canRemove}}
      <p>
        <button class="delete-group">Delete group</button>
        {{! TODO: Add confirmation or undo for this action }}
      </p>
    {{/if}}
  {{/if}}
</template>

<template name="groupInlineItem">
  <a class="inline-item group" {{#unless noLink}}href="{{groupPathFromId _id slug}}"{{/unless}}>
    <i class="avatar only-icon icon-group" title="Group"></i>
    <span class="name" title="{{name}}">{{name}}</span>
  </a>
</template>

<template name="groupCatalogItem">
  <li class="catalog-item group">
    {{> groupCatalogItemName}}
    <span class="group-count">{{countDescription}}</span>
    <a class="full-item-link" href="{{groupPathFromId _id slug}}"></a>
  </li>
</template>

<template name="groupCatalogItemName">
  <h2>
    <a href="{{groupPathFromId _id slug}}" class="actionable">
      {{name}}
    </a>
  </h2>
</template>
